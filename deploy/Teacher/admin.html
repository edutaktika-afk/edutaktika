<script>
document.addEventListener("DOMContentLoaded", function() {
    firebase.auth().onAuthStateChanged(async function(user) {
        if (!user) {
            window.location.href = "logreg.html";
            return;
        }
        const uid = user.uid;
        const snap = await firebase.database().ref('admins/' + uid).once('value');
        const admin = snap.val();
        if (!admin || admin.role !== "admin") {
            document.getElementById('mainContent').style.display = "none";
            alert("Access denied. Only admins can access this page.");
            await firebase.auth().signOut();
            window.location.href = "logreg.html";
        } else {
            document.getElementById('mainContent').style.display = "block";
            // Show Gmail and role in the dropdown
            document.getElementById('adminEmail').textContent = admin.email || user.email;
            document.getElementById('adminUsername').textContent = '@' + (admin.role || 'admin');
        }
    });
});
</script>

<!DOCTYPE html>
<html>
<head>
    <title>Admin - Teacher Approvals</title>
        <link rel="stylesheet" href="../CSS/fonts.css">
<!-- ...inside <head> -->
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@600;700&family=Manrope:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        table { border-collapse: collapse; width: 90%; margin: 30px auto; }
        th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
        th { background: #2e8b57;; color: #fff; }
        .approved { color: green; font-weight: bold; }
        .pending { color: orange; font-weight: bold; }
        button { padding: 6px 16px; border-radius: 6px; border: none; cursor: pointer; }
        .approve { background: #4f8cff; color: #fff; }
        .reject { background: #ffb6b9; color: #232946; }
        .delete { background: #e53935; color: #fff; }
        .review { background: #ffd700; color: #232946; }
        /* Modal styles */
        .modal-bg {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0; top: 0; width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.4);
            align-items: center; justify-content: center;
        }
        .modal-box {
            background: #fff;
            border-radius: 16px;
            padding: 32px 36px;
            min-width: 320px;
            max-width: 95vw;
            box-shadow: 0 8px 32px #0003;
            position: relative;
        }
        .modal-close {
            position: absolute;
            top: 12px; right: 18px;
            background: #eee;
            border: none;
            border-radius: 50%;
            width: 32px; height: 32px;
            font-size: 1.3rem;
            cursor: pointer;
        }
        .modal-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 18px;
            color: #4f8cff;
        }
        .modal-content div {
            margin-bottom: 10px;
            font-size: 1.07rem;
        }
        .modal-label {
            font-weight: bold;
            color: #232946;
        }
        /* Admin bar styles */
        .admin-bar {
            position: fixed;
            top: 0; right: 0;
            z-index: 1;
            padding: 0 32px 0 0;
            width: 100vw;
            height: 70px;
            background:#2e8b57;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            box-shadow: 0 2px 12px #0002;
        }
        .admin-dropdown {
            position: relative;
            display: inline-block;
        }
        .admin-icon-btn {
            background: #fff;
            border: none;
            border-radius: 50%;
            width: 54px;
            height: 54px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.1rem;
            color: #2e8b57;
            cursor: pointer;
            box-shadow: 0 2px 8px #ffd70055;
            transition: background 0.2s, box-shadow 0.2s;
        }
        .admin-icon-btn:hover {
            background: #ffd700;
            color: #232946;
            box-shadow: 0 4px 16px #4f8cff44;
        }
        .admin-dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            top: 62px;
            background: #fff;
            min-width: 220px;
            border-radius: 12px;
            box-shadow: 0 4px 24px #0002;
            padding: 18px 22px 12px 22px;
            z-index: 10001;
            text-align: left;
        }
        .admin-dropdown-content.show {
            display: block;
            animation: fadeIn 0.2s;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px);}
            to { opacity: 1; transform: translateY(0);}
        }
        .admin-dropdown-content .admin-email,
        .admin-dropdown-content .admin-username {
            font-size: 1.05rem;
            color: #232946;
            margin-bottom: 8px;
            word-break: break-all;
        }
        .admin-dropdown-content .admin-username {
            color: #4f8cff;
            font-weight: bold;
        }
        .admin-dropdown-content .logout-btn {
            width: 100%;
            background: #ffd700;
            color: rgb(0, 0, 0);
            border: none;
            padding: 10px 0;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            font-size: 1.08rem;
            margin-top: 10px;
            box-shadow: 0 2px 8px #ffd70044;
            letter-spacing: 1px;
            transition: background 0.2s, color 0.2s;
        }
        .admin-dropdown-content .logout-btn:hover {
            background: #ff0000;
            color: #ffffff;
        }
        body { padding-top: 80px; }

        /* Admin modal styles */
        .admin-modal-bg {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0; top: 0; width: 100vw; height: 100vh;
            background: rgba(0,0,0,0.35);
            align-items: center; justify-content: center;
        }
        .admin-modal-card {
            background: linear-gradient(180deg, #ffe6f7 0%, #e0eaff 100%);
            border-radius: 28px;
            box-shadow: 0 4px 24px rgba(79,140,255,0.10);
            max-width: 400px;
            width: 95%;
            padding: 36px 24px 24px 24px;
            text-align: center;
            position: relative;
            font-family: 'Baloo 2', cursive, Arial, sans-serif;
            animation: sidebarDrop 0.5s cubic-bezier(.77,0,.18,1);
        }
        .admin-modal-card .close-btn {
            position: absolute;
            top: 18px;
            right: 18px;
            background: none;
            border: none;
            font-size: 1.7rem;
            color: #ff69b4;
            cursor: pointer;
            transition: color 0.2s;
        }
        .admin-modal-card .close-btn:hover {
            color: #2e8b57;
        }
        .admin-modal-card .profile-info {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 10px;
            width: 100%;
            max-width: 420px;
            max-height: 420px;           /* Limit height for scroll */
            overflow-y: auto;            /* Make content scrollable */
            border-radius: 18px;         /* Add border radius */
            background: #f7f9fb;         /* Optional: subtle background for contrast */
            padding: 10px 0;             /* Optional: inner padding */
            scrollbar-width: none;         /* Firefox */
    -ms-overflow-style: none; 
        }
        .admin-modal-card .profile-info::-webkit-scrollbar {
    display: none;                 /* Chrome, Safari, Opera */
}
        .admin-modal-card .profile-info > div {
            display: flex;
            align-items: center;
            background: #fff;
            border-radius: 14px;
            box-shadow: 0 2px 8px #e0eaff33;
            padding: 7px 14px;
            width: 100%;
            gap: 8px;
            font-size: 1.05rem;
            color: #3f4d34;
            margin: 0 auto;
            flex-wrap: nowrap;
            min-height: 32px;
            overflow-x: auto; /* Allow horizontal scroll for long content */
        }
        .admin-modal-card .profile-info .modal-label {
            min-width: 110px;
            color: #4faaff;
            font-weight: 600;
            font-size: 1.08rem;
            flex-shrink: 0;
        }
        .admin-modal-card .profile-info span:not(.modal-label) {
            margin-left: 8px;
            font-weight: 600;
            color: #3f4d34;
            font-family: 'Baloo 2', cursive;
            white-space: nowrap;
            flex: 1 1 0;
            min-width: 0;
        }
        #teachersTable {
    background: #fff;
    border-radius: 18px;
    box-shadow: 0 4px 24px #0001;
    overflow: hidden;
}
#teachersTable th, #teachersTable td {
    border: none;
}
#teachersTable th {
    background: var(--primary, #2e8b57);
    color: #fff;
    font-size: 1.08rem;
    letter-spacing: 1px;
}
#teachersTable tbody tr {
    transition: background 0.18s;
}
#teachersTable tbody tr:hover {
    background: #e0ffe6;
}
#teachersTable td {
    background: #fff;
    font-size: 1.05rem;
    vertical-align: middle;
}

.review {
    font-weight: 600;
    border: none;
    background: #ffd700;
    color: #232946;
    border-radius: 8px;
    padding: 6px 18px;
    cursor: pointer;
    transition: background 0.18s;
}
.review:hover {
    background: #ff69b4;
    color: #fff;
}
/* Hide action buttons by default */
.action-btns button {
    display: none;
}

/* Show on hover of the Action cell */
td:hover .action-btns button {
    display: inline-block;
    margin: 0 2px;
}

.action-btns {
    position: relative;
    min-width: 120px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.action-btns .action-main {
    display: inline-flex;
    align-items: center;
    gap: 7px;
    background: #ffd700;
    color: #232946;
    border-radius: 8px;
    padding: 7px 18px;
    font-weight: 700;
    font-size: 1.05rem;
    border: none;
    cursor: pointer;
    box-shadow: 0 2px 8px #ffd70033;
    transition: opacity 0.25s, transform 0.25s;
    z-index: 1;
    position: absolute;
    left: 50%; top: 50%;
    transform: translate(-50%, -50%);
    opacity: 1;
    pointer-events: auto;
}

.action-btns .approve,
.action-btns .reject {
    opacity: 0;
    pointer-events: none;
    transform: translateY(10px) scale(0.95);
    transition: opacity 0.25s, transform 0.25s;
    margin: 0 4px;
    font-size: 1.05rem;
    font-weight: 700;
    border-radius: 8px;
    border: none;
    box-shadow: 0 2px 8px #ffd70033;
    padding: 7px 16px;
}

.action-btns .approve {
    background: #4f8cff;
    color: #fff;
    border: 2px solid #4f8cff;
}
.action-btns .approve:hover {
    background: #ffd700;
    color: #232946;
    border-color: #ffd700;
}

.action-btns .reject {
    background: #ffb6b9;
    color: #232946;
    border: 2px solid #ffb6b9;
}
.action-btns .reject:hover {
    background: #ff2323;
    color: #fff;
    border-color: #ff2323;
}

/* On hover, hide Action button and show Approve/Reject smoothly */
td:hover .action-btns .action-main,
.action-btns:focus-within .action-main {
    opacity: 0;
    pointer-events: none;
    transform: translate(-50%, -50%) scale(0.95);
}

td:hover .action-btns .approve,
td:hover .action-btns .reject,
.action-btns:focus-within .approve,
.action-btns:focus-within .reject {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0) scale(1);
}

/* Optional: highlight Action cell on hover */
#teachersTable td:nth-child(8):hover {
    background: #fffbe6;
    box-shadow: 0 2px 12px #ffd70055;
    transition: background 0.2s, box-shadow 0.2s;
    position: relative;
    z-index: 2;
}
    </style>
</head>
<body>
    <div id="mainContent" style="display:none;">
    <!-- Admin bar with icon and dropdown -->
    <div class="admin-bar">
        <div class="admin-dropdown">
            <button class="admin-icon-btn" id="adminDropdownBtn" title="Admin">
                <i class="fas fa-user-shield"></i>
            </button>
            <div class="admin-dropdown-content" id="adminDropdownContent">
                <div class="admin-email" id="adminEmail">admin@email.com</div>
                <div class="admin-username" id="adminUsername">@admin</div>
                <button class="logout-btn" onclick="logoutAdmin()">Logout</button>
            </div>
        </div>
    </div>

    <!-- Modern Admin Dashboard -->
    <div style="max-width: 1400px; margin: 0 auto; padding: 20px;">
        <!-- Dashboard Header -->
        <div style="background: linear-gradient(135deg, #2e8b57 0%, #3cb371 100%); color: white; padding: 30px; border-radius: 16px; margin-bottom: 30px; box-shadow: 0 8px 32px rgba(46, 139, 87, 0.3);">
            <h1 style="margin: 0; font-size: 2.5rem; font-weight: 700; text-align: center;">Admin Dashboard</h1>
            <p style="margin: 10px 0 0 0; text-align: center; font-size: 1.1rem; opacity: 0.9;">Manage your educational platform</p>
        </div>

        <!-- Navigation Tabs -->
        <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.1);">
            <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                <button id="tabAdmins" class="nav-tab active" onclick="showTab('admins')" style="background: #2e8b57; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease;">
                    <i class="fas fa-user-shield"></i> Admin Management
                </button>
                <button id="tabStudents" class="nav-tab" onclick="showTab('students')" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease;">
                    <i class="fas fa-user-graduate"></i> Student Management
                </button>
                <button id="tabTeachers" class="nav-tab" onclick="showTab('teachers')" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease;">
                    <i class="fas fa-chalkboard-teacher"></i> Teacher Approvals
                </button>
            </div>
        </div>

        <!-- Admin Management Tab -->
        <div id="contentAdmins" class="tab-content" style="display: block;">
            <div style="background: white; border-radius: 16px; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                    <h2 style="color: #2e8b57; margin: 0; font-size: 1.8rem; font-weight: 700;">
                        <i class="fas fa-user-shield" style="margin-right: 10px;"></i>Admin Management
                    </h2>
                    <button id="createAdminBtn" style="background: linear-gradient(135deg, #2e8b57 0%, #3cb371 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; box-shadow: 0 4px 15px rgba(46, 139, 87, 0.3); transition: all 0.3s ease;">
                        <i class="fas fa-user-plus"></i> Create New Admin
                    </button>
                </div>
                
                <!-- Create Admin Form (Hidden by default) -->
                <div id="createAdminForm" style="display: none; background: #f8f9fa; padding: 25px; border-radius: 12px; margin-bottom: 25px; border: 1px solid #e9ecef;">
                    <h3 style="color: #2e8b57; margin-bottom: 20px; font-size: 1.3rem;">Create New Admin Account</h3>
                    <form id="adminForm">
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">First Name</label>
                                <input type="text" id="adminFname" required style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; transition: border-color 0.3s ease;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Last Name</label>
                                <input type="text" id="adminLname" required style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; transition: border-color 0.3s ease;">
                            </div>
                        </div>
                        <div style="margin-bottom: 20px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Email Address</label>
                            <input type="email" id="adminEmail" required style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; transition: border-color 0.3s ease;">
                        </div>
                        <div style="margin-bottom: 25px;">
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Password</label>
                            <input type="password" id="adminPassword" required style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; transition: border-color 0.3s ease;">
                            <small style="color: #6c757d; font-size: 12px; margin-top: 5px; display: block;">Password must be at least 8 characters with uppercase, lowercase, number, and special character.</small>
                        </div>
                        <div style="display: flex; gap: 15px; justify-content: flex-end;">
                            <button type="button" id="cancelAdminBtn" style="background: #6c757d; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; transition: all 0.3s ease;">Cancel</button>
                            <button type="submit" style="background: linear-gradient(135deg, #2e8b57 0%, #3cb371 100%); color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 14px; font-weight: 600; box-shadow: 0 4px 15px rgba(46, 139, 87, 0.3); transition: all 0.3s ease;">Create Admin</button>
                        </div>
                    </form>
                </div>
                
                <!-- Current Admins List -->
                <div id="adminsList">
                    <h3 style="color: #2e8b57; margin-bottom: 20px; font-size: 1.3rem;">Current Admins</h3>
                    <div style="overflow-x: auto;">
                        <table id="adminsTable" style="width: 100%; border-collapse: collapse; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #2e8b57 0%, #3cb371 100%); color: white;">
                                    <th style="padding: 15px; text-align: left; font-weight: 600;">Name</th>
                                    <th style="padding: 15px; text-align: left; font-weight: 600;">Email</th>
                                    <th style="padding: 15px; text-align: left; font-weight: 600;">Created</th>
                                    <th style="padding: 15px; text-align: center; font-weight: 600;">Actions</th>
                                </tr>
                            </thead>
                            <tbody id="adminsTableBody">
                                <!-- Admin rows will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Student Management Tab -->
        <div id="contentStudents" class="tab-content" style="display: none;">
            <div style="background: white; border-radius: 16px; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
                <h2 style="color: #2e8b57; margin-bottom: 25px; font-size: 1.8rem; font-weight: 700;">
                    <i class="fas fa-user-graduate" style="margin-right: 10px;"></i>Student Account Management
                </h2>
                
                <!-- Student Search and Filters -->
                <div style="background: #f8f9fa; padding: 20px; border-radius: 12px; margin-bottom: 25px; border: 1px solid #e9ecef;">
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 15px; align-items: end;">
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Search Students</label>
                            <input type="text" id="studentSearch" placeholder="Search by name, email, or ID..." 
                                   style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; transition: border-color 0.3s ease;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Grade Level</label>
                            <select id="gradeFilter" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; background: white;">
                                <option value="">All Grades</option>
                                <option value="Grade 5">Grade 5</option>
                                <option value="Grade 6">Grade 6</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #333;">Section</label>
                            <select id="sectionFilter" style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 14px; background: white;">
                                <option value="">All Sections</option>
                                <option value="A">Section A</option>
                                <option value="B">Section B</option>
                                <option value="C">Section C</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <!-- Students Table -->
                <div style="overflow-x: auto;">
                    <table id="studentsTable" style="width: 100%; border-collapse: collapse; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #2e8b57 0%, #3cb371 100%); color: white;">
                                <th style="padding: 15px; text-align: left; font-weight: 600;">ID</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Name</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Email</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Grade</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Section</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Subject</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Registered</th>
                                <th style="padding: 15px; text-align: center; font-weight: 600;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="studentsTableBody">
                            <!-- Student rows will be inserted here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Teacher Approvals Tab -->
        <div id="contentTeachers" class="tab-content" style="display: none;">
            <div style="background: white; border-radius: 16px; padding: 30px; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
                <h2 style="color: #2e8b57; margin-bottom: 25px; font-size: 1.8rem; font-weight: 700;">
                    <i class="fas fa-chalkboard-teacher" style="margin-right: 10px;"></i>Teacher Account Approvals
                </h2>
                <div style="overflow-x: auto;">
                    <table id="teachersTable" style="width: 100%; border-collapse: collapse; background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #2e8b57 0%, #3cb371 100%); color: white;">
                                <th style="padding: 15px; text-align: left; font-weight: 600;">ID</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Name</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Email</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Grade Level</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Section</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Students</th>
                                <th style="padding: 15px; text-align: left; font-weight: 600;">Status</th>
                                <th style="padding: 15px; text-align: center; font-weight: 600;">Action</th>
                                <th style="padding: 15px; text-align: center; font-weight: 600;">Delete</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Rows will be inserted here by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for teacher review -->
    <div class="admin-modal-bg" id="reviewModal">
        <div class="admin-modal-card">
            <button class="close-btn" onclick="closeReviewModal()">&times;</button>
            <div style="display:flex;flex-direction:column;align-items:center;">
                <img class="profile-avatar" src="https://api.dicebear.com/7.x/bottts/svg?seed=teacher" alt="Teacher Avatar" style="width:80px;height:80px;border-radius:50%;border:3px solid #ffd700;margin-bottom:10px;">
            </div>
            <div class="profile-name" id="modalTeacherName" style="font-size:1.3em;font-family:'Baloo 2',cursive;color:#2e8b57;margin-bottom:2px;text-align:center;">Teacher Name</div>
            <div class="profile-role" style="color:#2e8b57;font-weight:700;font-size:1.05rem;margin-bottom:14px;letter-spacing:1px;text-align:center;">
                Teacher
            </div>
            <div class="profile-info" id="modalContent" style="width:100%;max-width:420px;margin:0 auto 0 auto;">
                <!-- Details will be filled by JS -->
            </div>
        </div>
    </div>

    <!-- Modal for student review -->
    <div class="admin-modal-bg" id="studentReviewModal">
        <div class="admin-modal-card">
            <button class="close-btn" onclick="closeStudentReviewModal()">&times;</button>
            <div style="display:flex;flex-direction:column;align-items:center;">
                <img class="profile-avatar" src="https://api.dicebear.com/7.x/bottts/svg?seed=student" alt="Student Avatar" style="width:80px;height:80px;border-radius:50%;border:3px solid #ffd700;margin-bottom:10px;">
            </div>
            <div class="profile-name" id="modalStudentName" style="font-size:1.3em;font-family:'Baloo 2',cursive;color:#2e8b57;margin-bottom:2px;text-align:center;">Student Name</div>
            <div class="profile-role" style="color:#2e8b57;font-weight:700;font-size:1.05rem;margin-bottom:14px;letter-spacing:1px;text-align:center;">
                Student
            </div>
            <div class="profile-info" id="studentModalContent" style="width:100%;max-width:420px;margin:0 auto 0 auto;">
                <!-- Details will be filled by JS -->
            </div>
            <div style="margin-top: 20px; display: flex; gap: 10px; justify-content: center;">
                <button onclick="editStudent()" style="background: #007bff; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 14px;">
                    <i class="fas fa-edit"></i> Edit Student
                </button>
                <button onclick="deleteStudentFromModal()" style="background: #dc3545; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 14px;">
                    <i class="fas fa-trash"></i> Delete Student
                </button>
            </div>
        </div>
    </div>

    <!-- Modal for student editing -->
    <div class="admin-modal-bg" id="studentEditModal">
        <div class="admin-modal-card" style="max-width: 500px;">
            <button class="close-btn" onclick="closeStudentEditModal()">&times;</button>
            <h4 style="color: #2e8b57; margin-bottom: 20px; text-align: center;">Edit Student Information</h4>
            <form id="studentEditForm">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #333;">First Name:</label>
                        <input type="text" id="editFname" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #333;">Last Name:</label>
                        <input type="text" id="editLname" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                    </div>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #333;">Email:</label>
                    <input type="email" id="editEmail" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #333;">Grade:</label>
                        <select id="editGrade" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="Grade 5">Grade 5</option>
                            <option value="Grade 6">Grade 6</option>
                        </select>
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #333;">Section:</label>
                        <select id="editSection" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <option value="A">Section A</option>
                            <option value="B">Section B</option>
                            <option value="C">Section C</option>
                        </select>
                    </div>
                </div>
                <div style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #333;">Subject:</label>
                    <select id="editSubject" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                        <option value="Math">Math</option>
                        <option value="English">English</option>
                        <option value="Science">Science</option>
                    </select>
                </div>
                <div style="display: flex; gap: 10px; justify-content: flex-end;">
                    <button type="button" onclick="closeStudentEditModal()" style="background: #6c757d; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Cancel</button>
                    <button type="submit" style="background: #2e8b57; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">Save Changes</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <script>
    // Your Firebase config
    const firebaseConfig = {
        apiKey: "AIzaSyB5BbeLLvPX8l1c4Lq0f-CmIUml4hQOQlE",
        authDomain: "edutaktika.firebaseapp.com",
        databaseURL: "https://edutaktika-default-rtdb.firebaseio.com",
        projectId: "edutaktika",
        storageBucket: "edutaktika.appspot.com",
        messagingSenderId: "676848575316",
        appId: "1:676848575316:web:f78f8c0f83bf3d9dfb5ec1",
        measurementId: "G-X3GT5TNN87"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Admin dropdown logic
    document.getElementById('adminDropdownBtn').onclick = function() {
        document.getElementById('adminDropdownContent').classList.toggle('show');
    };
    window.addEventListener('click', function(e) {
        if (!document.getElementById('adminDropdownBtn').contains(e.target) &&
            !document.getElementById('adminDropdownContent').contains(e.target)) {
            document.getElementById('adminDropdownContent').classList.remove('show');
        }
    });

    // Remove session check: anyone can view and interact
    document.getElementById('adminEmail').textContent = "admin@email.com";
    document.getElementById('adminUsername').textContent = "@admin";

    function logoutAdmin() {
        firebase.auth().signOut().then(() => {
            window.location.href = "logreg.html";
        });
    }

    // Load teachers from Firebase
function loadTeachers() {
    // Fetch all students first
    db.ref('students').once('value').then(studentSnap => {
        const students = [];
        studentSnap.forEach(child => {
            students.push(child.val());
        });

        // Then fetch all teachers
        db.ref('teachers').once('value').then(snapshot => {
            const tbody = document.querySelector('#teachersTable tbody');
            tbody.innerHTML = '';
            snapshot.forEach(child => {
                const t = child.val();
                // Count students in the same section as this teacher
                const studentCount = students.filter(s => s.section === t.section).length;
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${t.id || ''}</td>
                    <td>
                        <button class="review" onclick="reviewTeacher('${child.key}')">${(t.fname || '') + ' ' + (t.lname || '')}</button>
                    </td>
                    <td>${t.email || ''}</td>
                    <td>${t.grade || ''}</td>
                    <td>${t.section || ''}</td>
                    <td>${studentCount}</td>
                    <td>
                        ${t.approved ? '<span class="approved">Approved</span>' : '<span class="pending">Pending</span>'}
                    </td>
                   <td>
                        <div class="action-btns">
                            ${!t.approved ? `
                                <button class="action-main" title="Take Action"><i class="fas fa-ellipsis-h"></i> Action</button>
                                <button class="approve" onclick="approveTeacher('${child.key}')">Approve</button>
                                <button class="reject" onclick="rejectTeacher('${child.key}')">Reject</button>
                            ` : '<span style="color:#aaa;">—</span>'}
                        </div>
                    </td>
                    <td>
                        <button class="delete" onclick="deleteTeacher('${child.key}')">Delete</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        });
    });
}

    // Approve teacher
    function approveTeacher(key) {
        const btn = document.querySelector(`button.approve[onclick="approveTeacher('${key}')"]`);
        const tr = btn ? btn.closest('tr') : null;

        db.ref('teachers/' + key).update({ 
            approved: true,
            approvedAt: new Date().toISOString()
        })
            .then(() => {
                if (tr) {
                    tr.querySelector('td:nth-child(6)').innerHTML = '<span class="approved">Approved</span>';
                    tr.querySelector('td:nth-child(7)').innerHTML = '<span style="color:#aaa;">—</span>';
                }
                alert('Teacher approved!');
            })
            .catch(err => alert('Error approving teacher: ' + err.message));
    }

    // Reject (delete) teacher
    function rejectTeacher(key) {
        if (confirm('Reject and delete this teacher?')) {
            db.ref('teachers/' + key).remove()
                .then(() => {
                    alert('Teacher rejected and deleted.');
                    loadTeachers();
                })
                .catch(err => alert('Error deleting teacher: ' + err.message));
        }
    }

    // Delete teacher (separate from reject, always available)
    function deleteTeacher(key) {
        if (confirm('Delete this teacher account?')) {
            db.ref('teachers/' + key).remove()
                .then(() => {
                    alert('Teacher deleted.');
                    loadTeachers();
                })
                .catch(err => alert('Error deleting teacher: ' + err.message));
        }
    }

    // Review teacher (show modal)
    function reviewTeacher(key) {
        db.ref('teachers/' + key).once('value').then(snapshot => {
            const t = snapshot.val();
            if (!t) return;
            document.getElementById('modalTeacherName').textContent = `${(t.fname || '')} ${(t.mname || '')} ${(t.lname || '')}`;
            let html = `
                <div><span class="modal-label">ID:</span> <span>${t.id || ''}</span></div>
                <div><span class="modal-label">First Name:</span> <span>${t.fname || ''}</span></div>
                <div><span class="modal-label">Middle Name:</span> <span>${t.mname || ''}</span></div>
                <div><span class="modal-label">Last Name:</span> <span>${t.lname || ''}</span></div>
                <div><span class="modal-label">Email:</span> <span>${t.email || ''}</span></div>
                <div><span class="modal-label">Grade Level:</span> <span>${t.grade || ''}</span></div>
                <div><span class="modal-label">Section:</span> <span>${t.section || ''}</span></div>
                <div><span class="modal-label">Address:</span> <span>${t.address || ''}</span></div>
                <div><span class="modal-label">Gender:</span> <span>${t.gender || ''}</span></div>
                <div><span class="modal-label">Age:</span> <span>${t.age || ''}</span></div>
                <div><span class="modal-label">School Year:</span> <span>${t.school_year || ''}</span></div>
                <div><span class="modal-label">Status:</span> <span>${t.approved ? '<span class="approved">Approved</span>' : '<span class="pending">Pending</span>'}</span></div>
                <div><span class="modal-label">Registered:</span> <span>${t.registeredAt ? new Date(t.registeredAt).toLocaleString() : '—'}</span></div>
                <div><span class="modal-label">Approved At:</span> <span>${t.approvedAt ? new Date(t.approvedAt).toLocaleString() : '—'}</span></div>
            `;
            document.getElementById('modalContent').innerHTML = html;
            document.getElementById('reviewModal').style.display = 'flex';
        });
    }
    function closeReviewModal() {
        document.getElementById('reviewModal').style.display = 'none';
    }

    // Admin Management Functions
    let currentAdmin = null;

    // Load current admin info
    function loadCurrentAdmin() {
        firebase.auth().onAuthStateChanged(async function(user) {
            if (user) {
                const uid = user.uid;
                const snap = await db.ref('admins/' + uid).once('value');
                const admin = snap.val();
                if (admin && admin.role === "admin") {
                    currentAdmin = admin;
                    currentAdmin.uid = uid;
                    loadAdmins();
                }
            }
        });
    }

    // Load all admins
    function loadAdmins() {
        db.ref('admins').once('value').then(snapshot => {
            const tbody = document.querySelector('#adminsTableBody');
            tbody.innerHTML = '';
            snapshot.forEach(child => {
                const admin = child.val();
                if (admin.role === "admin") {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td style="padding: 12px; border-bottom: 1px solid #eee;">${(admin.fname || '') + ' ' + (admin.lname || '')}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #eee;">${admin.email || ''}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #eee;">${admin.createdAt ? new Date(admin.createdAt).toLocaleDateString() : '—'}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">
                            ${child.key !== currentAdmin.uid ? 
                                `<button onclick="deleteAdmin('${child.key}')" style="background: #dc3545; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">Delete</button>` : 
                                '<span style="color: #28a745; font-weight: bold;">Current Admin</span>'
                            }
                        </td>
                    `;
                    tbody.appendChild(tr);
                }
            });
        });
    }

    // Create new admin
    async function createAdmin(adminData) {
        try {
            // Create user in Firebase Auth
            const userCredential = await firebase.auth().createUserWithEmailAndPassword(adminData.email, adminData.password);
            const user = userCredential.user;
            const uid = user.uid;

            // Save admin data in Realtime Database
            const newAdminData = {
                fname: adminData.fname,
                lname: adminData.lname,
                email: adminData.email,
                role: "admin",
                createdAt: new Date().toISOString(),
                createdBy: currentAdmin.uid
            };

            await db.ref('admins/' + uid).set(newAdminData);

            // Send verification email
            try {
                await user.sendEmailVerification();
            } catch (err) {
                console.log("Failed to send verification email: " + err.message);
            }

            // Sign out the created user (we don't want to stay logged in as them)
            await firebase.auth().signOut();

            alert('Admin created successfully! Verification email sent.');
            document.getElementById('adminForm').reset();
            document.getElementById('createAdminForm').style.display = 'none';
            loadAdmins();

        } catch (error) {
            console.error('Error creating admin:', error);
            alert('Error creating admin: ' + error.message);
        }
    }

    // Delete admin
    function deleteAdmin(adminUid) {
        if (confirm('Are you sure you want to delete this admin? This action cannot be undone.')) {
            db.ref('admins/' + adminUid).remove()
                .then(() => {
                    alert('Admin deleted successfully.');
                    loadAdmins();
                })
                .catch(err => {
                    console.error('Error deleting admin:', err);
                    alert('Error deleting admin: ' + err.message);
                });
        }
    }

    // Event listeners for admin management
    document.getElementById('createAdminBtn').onclick = function() {
        document.getElementById('createAdminForm').style.display = 'block';
    };

    document.getElementById('cancelAdminBtn').onclick = function() {
        document.getElementById('createAdminForm').style.display = 'none';
        document.getElementById('adminForm').reset();
    };

    document.getElementById('adminForm').onsubmit = function(e) {
        e.preventDefault();
        
        const fname = document.getElementById('adminFname').value;
        const lname = document.getElementById('adminLname').value;
        const email = document.getElementById('adminEmail').value;
        const password = document.getElementById('adminPassword').value;

        // Password validation
        const strongPasswordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,}$/;
        if (!strongPasswordRegex.test(password)) {
            alert('Password must be at least 8 characters and include uppercase, lowercase, number, and special character.');
            return;
        }

        const adminData = { fname, lname, email, password };
        createAdmin(adminData);
    };

    // Student Management Functions
    let currentStudent = null;
    let allStudents = [];

    // Load all students
    function loadStudents() {
        db.ref('students').once('value').then(snapshot => {
            allStudents = [];
            const tbody = document.querySelector('#studentsTableBody');
            tbody.innerHTML = '';
            
            snapshot.forEach(child => {
                const student = child.val();
                allStudents.push({ ...student, uid: child.key });
                
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.id || ''}</td>
                    <td style="padding: 12px; border-bottom: 1px solid #eee;">
                        <button onclick="reviewStudent('${child.key}')" style="background: none; border: none; color: #2e8b57; cursor: pointer; font-weight: 600; text-decoration: underline;">
                            ${(student.fname || '') + ' ' + (student.lname || '')}
                        </button>
                    </td>
                    <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.email || ''}</td>
                    <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.gradelevel || ''}</td>
                    <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.section || ''}</td>
                    <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.subject || ''}</td>
                    <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.registeredAt ? new Date(student.registeredAt).toLocaleDateString() : '—'}</td>
                    <td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">
                        <button onclick="editStudent('${child.key}')" style="background: #007bff; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-right: 5px;">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button onclick="deleteStudent('${child.key}')" style="background: #dc3545; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        });
    }

    // Review student (show modal)
    function reviewStudent(studentUid) {
        const student = allStudents.find(s => s.uid === studentUid);
        if (!student) return;
        
        currentStudent = student;
        document.getElementById('modalStudentName').textContent = `${(student.fname || '')} ${(student.lname || '')}`;
        
        let html = `
            <div><span class="modal-label">ID:</span> <span>${student.id || ''}</span></div>
            <div><span class="modal-label">First Name:</span> <span>${student.fname || ''}</span></div>
            <div><span class="modal-label">Last Name:</span> <span>${student.lname || ''}</span></div>
            <div><span class="modal-label">Email:</span> <span>${student.email || ''}</span></div>
            <div><span class="modal-label">Grade Level:</span> <span>${student.gradelevel || ''}</span></div>
            <div><span class="modal-label">Section:</span> <span>${student.section || ''}</span></div>
            <div><span class="modal-label">Subject:</span> <span>${student.subject || ''}</span></div>
            <div><span class="modal-label">Gender:</span> <span>${student.gender || ''}</span></div>
            <div><span class="modal-label">Age:</span> <span>${student.age || ''}</span></div>
            <div><span class="modal-label">School Year:</span> <span>${student.school_year || ''}</span></div>
            <div><span class="modal-label">Registered:</span> <span>${student.registeredAt ? new Date(student.registeredAt).toLocaleString() : '—'}</span></div>
        `;
        
        document.getElementById('studentModalContent').innerHTML = html;
        document.getElementById('studentReviewModal').style.display = 'flex';
    }

    // Edit student
    function editStudent(studentUid = null) {
        const student = studentUid ? allStudents.find(s => s.uid === studentUid) : currentStudent;
        if (!student) return;
        
        currentStudent = student;
        
        // Populate form with current student data
        document.getElementById('editFname').value = student.fname || '';
        document.getElementById('editLname').value = student.lname || '';
        document.getElementById('editEmail').value = student.email || '';
        document.getElementById('editGrade').value = student.gradelevel || 'Grade 5';
        document.getElementById('editSection').value = student.section || 'A';
        document.getElementById('editSubject').value = student.subject || 'Math';
        
        document.getElementById('studentEditModal').style.display = 'flex';
    }

    // Delete student
    function deleteStudent(studentUid) {
        if (confirm('Are you sure you want to delete this student? This action cannot be undone.')) {
            db.ref('students/' + studentUid).remove()
                .then(() => {
                    alert('Student deleted successfully.');
                    loadStudents();
                })
                .catch(err => {
                    console.error('Error deleting student:', err);
                    alert('Error deleting student: ' + err.message);
                });
        }
    }

    // Delete student from modal
    function deleteStudentFromModal() {
        if (currentStudent) {
            deleteStudent(currentStudent.uid);
            closeStudentReviewModal();
        }
    }

    // Update student
    function updateStudent(studentData) {
        if (!currentStudent) return;
        
        db.ref('students/' + currentStudent.uid).update(studentData)
            .then(() => {
                alert('Student updated successfully.');
                closeStudentEditModal();
                loadStudents();
            })
            .catch(err => {
                console.error('Error updating student:', err);
                alert('Error updating student: ' + err.message);
            });
    }

    // Close modals
    function closeStudentReviewModal() {
        document.getElementById('studentReviewModal').style.display = 'none';
        currentStudent = null;
    }

    function closeStudentEditModal() {
        document.getElementById('studentEditModal').style.display = 'none';
    }

    // Student search and filter
    function filterStudents() {
        const searchTerm = document.getElementById('studentSearch').value.toLowerCase();
        const gradeFilter = document.getElementById('gradeFilter').value;
        const sectionFilter = document.getElementById('sectionFilter').value;
        
        const tbody = document.querySelector('#studentsTableBody');
        tbody.innerHTML = '';
        
        const filteredStudents = allStudents.filter(student => {
            const matchesSearch = !searchTerm || 
                (student.fname && student.fname.toLowerCase().includes(searchTerm)) ||
                (student.lname && student.lname.toLowerCase().includes(searchTerm)) ||
                (student.email && student.email.toLowerCase().includes(searchTerm)) ||
                (student.id && student.id.toLowerCase().includes(searchTerm));
            
            const matchesGrade = !gradeFilter || student.gradelevel === gradeFilter;
            const matchesSection = !sectionFilter || student.section === sectionFilter;
            
            return matchesSearch && matchesGrade && matchesSection;
        });
        
        filteredStudents.forEach(student => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
                <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.id || ''}</td>
                <td style="padding: 12px; border-bottom: 1px solid #eee;">
                    <button onclick="reviewStudent('${student.uid}')" style="background: none; border: none; color: #2e8b57; cursor: pointer; font-weight: 600; text-decoration: underline;">
                        ${(student.fname || '') + ' ' + (student.lname || '')}
                    </button>
                </td>
                <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.email || ''}</td>
                <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.gradelevel || ''}</td>
                <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.section || ''}</td>
                <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.subject || ''}</td>
                <td style="padding: 12px; border-bottom: 1px solid #eee;">${student.registeredAt ? new Date(student.registeredAt).toLocaleDateString() : '—'}</td>
                <td style="padding: 12px; border-bottom: 1px solid #eee; text-align: center;">
                    <button onclick="editStudent('${student.uid}')" style="background: #007bff; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px; margin-right: 5px;">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button onclick="deleteStudent('${student.uid}')" style="background: #dc3545; color: white; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 12px;">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </td>
            `;
            tbody.appendChild(tr);
        });
    }

    // Event listeners for student management
    document.getElementById('studentSearch').addEventListener('input', filterStudents);
    document.getElementById('gradeFilter').addEventListener('change', filterStudents);
    document.getElementById('sectionFilter').addEventListener('change', filterStudents);

    document.getElementById('studentEditForm').onsubmit = function(e) {
        e.preventDefault();
        
        const studentData = {
            fname: document.getElementById('editFname').value,
            lname: document.getElementById('editLname').value,
            email: document.getElementById('editEmail').value,
            gradelevel: document.getElementById('editGrade').value,
            section: document.getElementById('editSection').value,
            subject: document.getElementById('editSubject').value,
            updatedAt: new Date().toISOString()
        };
        
        updateStudent(studentData);
    };

    // Tab Navigation Functions
    function showTab(tabName) {
        // Hide all tab contents
        document.querySelectorAll('.tab-content').forEach(content => {
            content.style.display = 'none';
        });
        
        // Remove active class from all tabs
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.style.background = '#6c757d';
        });
        
        // Show selected tab content
        document.getElementById('content' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.display = 'block';
        
        // Add active class to selected tab
        document.getElementById('tab' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).style.background = '#2e8b57';
    }

    // Enhanced table styling for better UX
    function enhanceTableStyling() {
        // Add hover effects to table rows
        const style = document.createElement('style');
        style.textContent = `
            .tab-content table tbody tr {
                transition: all 0.3s ease;
            }
            .tab-content table tbody tr:hover {
                background: #f8f9fa !important;
                transform: translateY(-1px);
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            }
            .tab-content table tbody td {
                padding: 15px;
                border-bottom: 1px solid #e9ecef;
                vertical-align: middle;
            }
            .tab-content input:focus, .tab-content select:focus {
                border-color: #2e8b57 !important;
                box-shadow: 0 0 0 3px rgba(46, 139, 87, 0.1) !important;
                outline: none !important;
            }
            .nav-tab:hover {
                transform: translateY(-2px);
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            }
            .approved {
                color: #28a745;
                font-weight: 600;
                background: #d4edda;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
            }
            .pending {
                color: #ffc107;
                font-weight: 600;
                background: #fff3cd;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 12px;
            }
        `;
        document.head.appendChild(style);
    }

    // Initial load
    loadCurrentAdmin();
    loadStudents();
    loadTeachers();
    enhanceTableStyling();
    </script>
    </div>
</body>
</html>